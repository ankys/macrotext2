<script type="text/javascript" src="macrotext.js"></script>
<script type="text/javascript">
(function() {
	var search = location.search;
if (search !== "") {
	var text = decodeURIComponent(search.replace(/^\?/, ""));
	var callback = function(code, src, args) {
		var type = mt.getMessageType(code);
		if (type === "Debug") {
			// return;
		}
		var pos = src.pos;
		var len = src.len;
		console.log(type, pos, len, code, args);
	};
	var mt = MacroText.create({ allowSystem: true, callback: callback });
	console.log(text);
	var node = mt.parse(text);
	// console.log(node);
	console.log(node.toString());
	var value = mt.evaluate(node);
	// console.log(value);
	console.log(value.toString());
}
})();
</script>

<textarea id="input" style="width: 40%; height: 90%">
test
</textarea>
<textarea id="output" readonly style="width: 40%; height: 90%">
</textarea>
<script type="text/javascript">
var eInput = document.getElementById("input");
var eOutput = document.getElementById("output");

function convert() {
	var mt = MacroText.create({ allowSystem: true, callback: null });
	var textInput = eInput.value;
	var textOutput = mt.evaluateAsString(mt.parse(textInput));
	eOutput.value = textOutput;
}
eInput.addEventListener("change", convert);
convert();
</script>